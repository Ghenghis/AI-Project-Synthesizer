"""
Shared test fixtures and configuration.
Auto-generated by Enterprise Test Generator
"""

import pytest
from unittest.mock import Mock, MagicMock, AsyncMock, patch
from typing import Any, Dict, List
import os
import sys

# Add project root to path
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from .mocks.mock_github import mock_github, mock_github_async
from .mocks.mock_huggingface import mock_huggingface, mock_huggingface_async
from .mocks.mock_kaggle import mock_kaggle, mock_kaggle_async
from .mocks.mock_elevenlabs import mock_elevenlabs, mock_elevenlabs_async
from .mocks.mock_openai import mock_openai, mock_openai_async
from .mocks.mock_anthropic import mock_anthropic, mock_anthropic_async
from .mocks.mock_ollama import mock_ollama, mock_ollama_async
from .mocks.mock_firecrawl import mock_firecrawl, mock_firecrawl_async
from .mocks.mock_http import mock_http, mock_http_async
from .mocks.mock_database import mock_database, mock_database_async
from .mocks.mock_filesystem import mock_filesystem, mock_filesystem_async


# ============================================================================
# Environment Fixtures
# ============================================================================

@pytest.fixture(scope="session")
def test_env():
    """Set up test environment variables."""
    env_vars = {'OPENAI_API_KEY': 'test-key', 'ANTHROPIC_API_KEY': 'test-key', 'GITHUB_TOKEN': 'test-token', 'ELEVENLABS_API_KEY': 'test-key', 'OLLAMA_HOST': 'http://localhost:11434'}
    original = {}
    for key, value in env_vars.items():
        original[key] = os.environ.get(key)
        os.environ[key] = value
    yield env_vars
    for key, value in original.items():
        if value is None:
            os.environ.pop(key, None)
        else:
            os.environ[key] = value


# ============================================================================
# Mock Fixtures
# ============================================================================




# ============================================================================
# Helper Functions
# ============================================================================

def assert_called_with_partial(mock, **expected):
    """Assert mock was called with at least the expected kwargs."""
    mock.assert_called()
    actual = mock.call_args.kwargs
    for key, value in expected.items():
        assert key in actual, f"Expected {key} in call args"
        assert actual[key] == value, f"Expected {key}={value}, got {actual[key]}"


def create_test_data(data_type: str, **kwargs) -> Any:
    """Create test data for common types."""
    factories = {
        'repo': lambda: {'url': 'https://github.com/test/repo', 'name': 'test-repo', **kwargs},
        'config': lambda: {'debug': True, 'timeout': 30, **kwargs},
        'user': lambda: {'id': 1, 'name': 'test_user', **kwargs},
    }
    return factories.get(data_type, lambda: kwargs)()
