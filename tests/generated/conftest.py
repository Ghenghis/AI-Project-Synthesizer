"""
Shared test fixtures and configuration.
Auto-generated by Enterprise Test Generator
"""

import os
import sys
from typing import Any

import pytest

# Add project root to path
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))


# ============================================================================
# Environment Fixtures
# ============================================================================

@pytest.fixture(scope="session")
def test_env():
    """Set up test environment variables."""
    env_vars = {'OPENAI_API_KEY': 'test-key', 'ANTHROPIC_API_KEY': 'test-key', 'GITHUB_TOKEN': 'test-token', 'ELEVENLABS_API_KEY': 'test-key', 'OLLAMA_HOST': 'http://localhost:11434'}
    original = {}
    for key, value in env_vars.items():
        original[key] = os.environ.get(key)
        os.environ[key] = value
    yield env_vars
    for key, value in original.items():
        if value is None:
            os.environ.pop(key, None)
        else:
            os.environ[key] = value


# ============================================================================
# Mock Fixtures
# ============================================================================




# ============================================================================
# Helper Functions
# ============================================================================

def assert_called_with_partial(mock, **expected):
    """Assert mock was called with at least the expected kwargs."""
    mock.assert_called()
    actual = mock.call_args.kwargs
    for key, value in expected.items():
        assert key in actual, f"Expected {key} in call args"
        assert actual[key] == value, f"Expected {key}={value}, got {actual[key]}"


def create_test_data(data_type: str, **kwargs) -> Any:
    """Create test data for common types."""
    factories = {
        'repo': lambda: {'url': 'https://github.com/test/repo', 'name': 'test-repo', **kwargs},
        'config': lambda: {'debug': True, 'timeout': 30, **kwargs},
        'user': lambda: {'id': 1, 'name': 'test_user', **kwargs},
    }
    return factories.get(data_type, lambda: kwargs)()
